"use strict";(()=>{var e={};e.id=41,e.ids=[41],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3709:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>l,routeModule:()=>g,serverHooks:()=>w,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>p,dynamic:()=>c});var o=r(9182),n=r(2007),s=r(6719),i=r(3442),u=r(3524);let c="force-dynamic",d=new u.PrismaClient;async function p(){try{let e=new Date,t=new Date(e.getTime()-864e5),r=new Date(e.getTime()-6048e5),[a,o,n,s,u,c,p,g,l]=await Promise.all([d.account.count(),d.account.count({where:{isActive:!0}}),d.tweet.count(),d.tweet.count({where:{createdAt:{gte:t}}}),d.tweet.count({where:{isTrending:!0}}),d.rewrite.count(),d.tweet.findFirst({orderBy:{engagementScore:"desc"},include:{account:{select:{username:!0}}},where:{createdAt:{gte:r}}}),d.collectionLog.findMany({orderBy:{startedAt:"desc"},take:5}),d.trendingTopic.findMany({where:{isTrending:!0},orderBy:{trendScore:"desc"},take:10})]),m=await d.tweet.aggregate({where:{createdAt:{gte:r}},_avg:{engagementScore:!0},_max:{engagementScore:!0},_sum:{likeCount:!0,retweetCount:!0,replyCount:!0,quoteCount:!0}}),w=[];for(let t=6;t>=0;t--){let r=new Date(e.getTime()-864e5*t),a=new Date(r.getTime()+864e5),o=await d.tweet.count({where:{createdAt:{gte:r,lt:a}}});w.push({date:r.toISOString().split("T")[0],tweets:o})}return i.NextResponse.json({overview:{totalAccounts:a,activeAccounts:o,totalTweets:n,tweetsLast24h:s,trendingTweets:u,totalRewrites:c},engagement:{averageScore:m._avg.engagementScore||0,maxScore:m._max.engagementScore||0,totalLikes:m._sum.likeCount||0,totalRetweets:m._sum.retweetCount||0,totalReplies:m._sum.replyCount||0,totalQuotes:m._sum.quoteCount||0},topTweet:p,recentActivity:g,trendingTopics:l,tweetVolume:w})}catch(e){return console.error("Error fetching dashboard stats:",e),i.NextResponse.json({error:"Failed to fetch dashboard statistics"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/dashboard/stats/route",pathname:"/api/dashboard/stats",filename:"route",bundlePath:"app/api/dashboard/stats/route"},resolvedPagePath:"/home/ubuntu/ai_tweet_monitor/app/app/api/dashboard/stats/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:w}=g,h="/api/dashboard/stats/route";function v(){return(0,s.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[372,609],()=>r(3709));module.exports=a})();